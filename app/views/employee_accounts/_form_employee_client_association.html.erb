<%= simple_form_for(@employee_account, :method => 'patch') do |f| %>
  <%= f.error_notification %>

  <%= hidden_field_tag 'edit_type', 'client_association'%>

  <%= f.input :name, placeholder: 'Name', disabled: true %>

  <strong>Has Access To:</strong>
  <%= f.radio_button :has_access_to, 'everyone'%> Everyone &nbsp;&nbsp;&nbsp;
  <%= f.radio_button :has_access_to, 'some'%> Some &nbsp;&nbsp;&nbsp;
  <%= f.radio_button :has_access_to, 'nobody' %> Nobody

  <br>
  <br>

  <%
      associated_clients = employee_account.client_accounts

  def isDisabled()
    if @employee_account.has_access_to == 'nobody' || @employee_account.has_access_to == 'everyone'
      return true
    end
    return false
  end

  def employeeHasAssociationWith (ledger_id)
    if @employee_account.has_access_to == 'nobody'
      return false
    elsif @employee_account.has_access_to == 'everyone'
      return true
    elsif @employee_account.has_access_to == 'some'
      associated_clients.each do |client|
        # ledger belongs to a client_account. Therefore, ledger_id belongs to a client_id.
        if client.id == ledger_id
          return true
        end
      end
    end
    return false
  end
%>

    <div class="form-actions">
      <!--TODO: Add confirmation message in both(positioned top and below) the submit buttons. Add -- , data: {confirm: 'This will wipe all previous associations, and re-register new associations.\n Are you sure?'}-->
      <%= f.button :submit , :disabled => true%>
      <%= link_to "Cancel", employee_accounts_path %>
    </div>

    <div class="ledger_list">
      <table class="table table-condensed table-striped">
        <thead>
          <tr>
            <td>
              <%= check_box_tag 'select_all', '', false,  :disabled => isDisabled() %>
              All
            </td>
            <th>Ledger Name</th>
            <th>Client Code</th>
            <th>Ledger Type</th>
          </tr>
        </thead>
        <tbody>
          <% ledgers.each do |ledger| %>
            <tr>
              <td>
                <%= check_box_tag 'client_associations[]', ledger.id, employeeHasAssociationWith(ledger.id), :disabled => isDisabled() %>
              </td>
              <td><%= ledger.name.titleize %></td>
              <td><%= ledger.client_code.nil? ? 'N/A' : ledger.client_code%></td>
              <td><%= ledger.client_code.nil? ? 'Internal' : 'Client'%></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>

    <div class="form-actions">
      <%= f.button :submit , :disabled => true%>
      <%= link_to "Cancel", employee_accounts_path %>
    </div>

  <% end %>
